{"ast":null,"code":"import { NavigationEnd } from \"@angular/router\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../services/employees-db.service\";\nimport * as i3 from \"../services/stores-db.service\";\nimport * as i4 from \"@angular/common\";\n\nfunction EmployeespageComponent_span_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate3(\" for \", ctx_r0.store.city, \", \", ctx_r0.store.address, \", \", ctx_r0.store.postalCode, \"\");\n  }\n}\n\nfunction EmployeespageComponent_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelementStart(1, \"button\", 8);\n    i0.ɵɵlistener(\"click\", function EmployeespageComponent_div_8_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return ctx_r4.btnBack_click();\n    });\n    i0.ɵɵtext(2, \"Back to all employees\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\n\nconst _c0 = function (a0) {\n  return {\n    storeId: a0\n  };\n};\n\nfunction EmployeespageComponent_li_11_span_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵelementStart(1, \"b\");\n    i0.ɵɵtext(2, \"Store:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3, \"\\u00A0\");\n    i0.ɵɵelementStart(4, \"a\", 12);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const employee_r6 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"queryParams\", i0.ɵɵpureFunction1(4, _c0, employee_r6.storeId));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate3(\"\", employee_r6.store.address, \" \", employee_r6.store.city, \", \", employee_r6.store.postalCode, \"\");\n  }\n}\n\nfunction EmployeespageComponent_li_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"li\", 9);\n    i0.ɵɵelementStart(1, \"b\");\n    i0.ɵɵtext(2, \"First Name:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3);\n    i0.ɵɵelement(4, \"br\");\n    i0.ɵɵelementStart(5, \"b\");\n    i0.ɵɵtext(6, \"Last Name:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(7);\n    i0.ɵɵelement(8, \"br\");\n    i0.ɵɵtemplate(9, EmployeespageComponent_li_11_span_9_Template, 6, 6, \"span\", 3);\n    i0.ɵɵelementStart(10, \"button\", 10);\n    i0.ɵɵlistener(\"click\", function EmployeespageComponent_li_11_Template_button_click_10_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const employee_r6 = restoredCtx.$implicit;\n      const ctx_r9 = i0.ɵɵnextContext();\n      return ctx_r9.btnModify_click(employee_r6);\n    });\n    i0.ɵɵtext(11, \"Modify\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function EmployeespageComponent_li_11_Template_button_click_12_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const employee_r6 = restoredCtx.$implicit;\n      const ctx_r11 = i0.ɵɵnextContext();\n      return ctx_r11.btnDelete_click(employee_r6);\n    });\n    i0.ɵɵtext(13, \"Delete\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const employee_r6 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", employee_r6.firstName, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", employee_r6.lastName, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.store == null);\n  }\n}\n\nfunction EmployeespageComponent_div_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelement(1, \"br\");\n    i0.ɵɵelementStart(2, \"button\", 13);\n    i0.ɵɵlistener(\"click\", function EmployeespageComponent_div_12_Template_button_click_2_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return ctx_r12.btnBack_click();\n    });\n    i0.ɵɵtext(3, \"Back to all employees\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\n\nexport let EmployeespageComponent = /*#__PURE__*/(() => {\n  class EmployeespageComponent {\n    constructor(activatedRoute, employeesDB, storesDB, router, route) {\n      this.activatedRoute = activatedRoute;\n      this.employeesDB = employeesDB;\n      this.storesDB = storesDB;\n      this.router = router;\n      this.route = route;\n      this.employees = [];\n      this.store = null;\n      this.navigationSubscription = this.router.events.subscribe(e => {\n        if (e instanceof NavigationEnd) {\n          this.initialiseInvites();\n        }\n      });\n    }\n\n    initialiseInvites() {\n      this.store = null;\n      this.employees = [];\n      let storeId = Number(this.route.snapshot.queryParamMap.get('storeId'));\n\n      if (this.route.snapshot.queryParamMap.get('storeId') == null) {\n        this.employeesDB.selectAll().then(data => {\n          this.employees = data;\n          console.info(data);\n        }).catch(err => {\n          this.employees = [];\n          console.error(err);\n        });\n      } else {\n        if (isNaN(storeId)) {\n          this.router.navigate(['employees']);\n        } else {\n          this.employeesDB.selectAllWhereStore(storeId).then(data => {\n            this.employees = data;\n            console.info(data);\n          }).catch(err => {\n            this.employees = [];\n            console.error(err);\n          });\n          this.storesDB.select(storeId).then(data => {\n            this.store = data;\n            console.info(data);\n          }).catch(err => {\n            this.store = null;\n            console.error(err);\n          });\n        }\n      }\n    }\n\n    ngOnInit() {}\n\n    ngOnDestroy() {\n      if (this.navigationSubscription) {\n        this.navigationSubscription.unsubscribe();\n      }\n    }\n\n    btnAdd_click() {\n      this.router.navigate(['addEmployee']);\n    }\n\n    btnModify_click(employee) {\n      this.router.navigate(['modifyEmployee/' + employee.id]);\n    }\n\n    btnDelete_click(employee) {\n      this.employeesDB.delete(employee, () => {\n        alert(\"Record deleted successfully\");\n      });\n      this.ngOnInit();\n    }\n\n    btnBack_click() {\n      this.router.navigate(['employees']);\n    }\n\n  }\n\n  EmployeespageComponent.ɵfac = function EmployeespageComponent_Factory(t) {\n    return new (t || EmployeespageComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.EmployeesDBService), i0.ɵɵdirectiveInject(i3.StoresDBService), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i1.ActivatedRoute));\n  };\n\n  EmployeespageComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: EmployeespageComponent,\n    selectors: [[\"app-employeespage\"]],\n    decls: 13,\n    vars: 4,\n    consts: [[1, \"m-4\"], [1, \"card\"], [1, \"card-header\"], [4, \"ngIf\"], [\"type\", \"button\", \"id\", \"btnAdd\", \"name\", \"btnAdd\", 1, \"btn\", \"btn-primary\", \"btn-sm\", \"me-4\", 3, \"click\"], [1, \"card-body\"], [1, \"list-group\"], [\"class\", \"list-group-item\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"button\", \"id\", \"btnTopBack\", \"name\", \"btnBack\", 1, \"btn\", \"btn-secondary\", \"btn-sm\", \"me-4\", 3, \"click\"], [1, \"list-group-item\"], [\"type\", \"button\", \"id\", \"btnModify\", \"name\", \"btnModify\", 1, \"btn\", \"btn-primary\", \"btn-sm\", \"me-4\", 3, \"click\"], [\"type\", \"button\", \"id\", \"btnDelete\", \"name\", \"btnDelete\", 1, \"btn\", \"btn-danger\", \"btn-sm\", \"me-4\", 3, \"click\"], [\"routerLink\", \"/employees\", 3, \"queryParams\"], [\"type\", \"button\", \"id\", \"btnBack\", \"name\", \"btnBack\", 1, \"btn\", \"btn-secondary\", \"btn-sm\", \"me-4\", 3, \"click\"]],\n    template: function EmployeespageComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵelementStart(2, \"div\", 2);\n        i0.ɵɵelementStart(3, \"h2\");\n        i0.ɵɵtext(4, \"List of Employees\");\n        i0.ɵɵtemplate(5, EmployeespageComponent_span_5_Template, 2, 3, \"span\", 3);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"button\", 4);\n        i0.ɵɵlistener(\"click\", function EmployeespageComponent_Template_button_click_6_listener() {\n          return ctx.btnAdd_click();\n        });\n        i0.ɵɵtext(7, \"Add new employee\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(8, EmployeespageComponent_div_8_Template, 3, 0, \"div\", 3);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"div\", 5);\n        i0.ɵɵelementStart(10, \"ul\", 6);\n        i0.ɵɵtemplate(11, EmployeespageComponent_li_11_Template, 14, 3, \"li\", 7);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(12, EmployeespageComponent_div_12_Template, 4, 0, \"div\", 3);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngIf\", ctx.store != null);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.store != null);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngForOf\", ctx.employees);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.store != null);\n      }\n    },\n    directives: [i4.NgIf, i4.NgForOf, i1.RouterLinkWithHref],\n    styles: [\"button[_ngcontent-%COMP%]{width:100%;margin-bottom:.2em}\"]\n  });\n  return EmployeespageComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}